{"mappings":";;AAAA;ACCO,MAAM,yCAAc,kCAAkC;AAUtD,SAAS,yCAAO,CAAC,MAA6B,EAAE,OAAiC,EAAE,MAA+B,EAAE;IACzH,OAAO,MAAM,EAAE,KAAK,GAChB,MAAM,CAAC,IAAI,KAAK,CAAC,8DAA8D,CAAC,CAAC,GACjF,OAAO,CAAC,KAAK,CAAC,CAAA;CACnB;;;ADZD,MAAM,qCAAe,GAAG,CAAC,GAA2B,EAAE,MAA6B,GAAG;IAAE,KAAK,EAAE,IAAI;CAAE,GAAK;IACxG,OAAO,IAAI,OAAO,CAAU,CAAC,OAAO,EAAE,MAAM,GAAK;QAC/C,IAAI,MAAM;QACV,IAAI,OAAO,GAAG,KAAK,QAAQ;YACzB,IAAI,yCAAc,CAAC,IAAI,CAAC,GAAG,CAAC,EAC1B,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,AAAC,GAAG,CAAY,OAAO,CAAC,yCAAc,EAAE,EAAE,CAAC,EAAE,QAAQ,CAAC;iBAE3E,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,EAAY,QAAQ,CAAC;eAG/C,MAAM,GAAG,GAAG;QAEd,IAAI,GAAG,YAAY,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,yCAAO,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC;QACtE,OAAO,YAAK,CAAC,MAAM,CAAC,CACjB,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC,CACd,QAAQ,CAAC,CAAC,GAAG,GAAK;YACjB,IAAI,CAAC,GAAG,EAAE,OAAO,CAAC,IAAI,CAAC;iBAClB,yCAAO,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC;SACtC,CAAC,CAAA;KACL,CAAC,CAAA;CACH;IAED,wCAA8B,GAAf,qCAAe","sources":["src/validateInNode.ts","src/shared.ts"],"sourcesContent":["import sharp from 'sharp'\nimport { failure, ImageValidationConfig, ImageValidationNodeSrc, IMG_DATA_REGEX } from './shared'\n\nconst ImageValidation = (src: ImageValidationNodeSrc, config: ImageValidationConfig = { throw: true }) => {\n  return new Promise<boolean>((resolve, reject) => {\n    let source\n    if (typeof src === 'string') {\n      if (IMG_DATA_REGEX.test(src)) {\n        source = Buffer.from((src as string).replace(IMG_DATA_REGEX, ''), 'base64')\n      } else {\n        source = Buffer.from(src as string, 'base64')\n      }\n    } else {\n      source = src\n    }\n    if (src instanceof Buffer && !src[0]) failure(config, resolve, reject)\n    return sharp(source)\n      .resize(52, 52)\n      .toBuffer((err) => {\n        if (!err) resolve(true)\n        else failure(config, resolve, reject)\n      })\n  })\n}\n\nexport default ImageValidation","/** The regex to detect if base64 string contains browser specific data image instruction */\nexport const IMG_DATA_REGEX = /^data:image\\/\\w{2,5};base64,/i\n\nexport type ImageValidationDomSrc = string | File\n\nexport type ImageValidationNodeSrc = Buffer | Uint8Array | Uint8ClampedArray | Int8Array | Uint16Array | Int16Array | Uint32Array | Int32Array | Float32Array | Float64Array | string\n\nexport interface ImageValidationConfig {\n  throw: boolean\n}\n\nexport function failure(config: ImageValidationConfig, resolve: (value: boolean) => void, reject: (reason: Error) => void) {\n  return config?.throw\n    ? reject(new Error('The media resource is either invalid, corrupt or not usable.'))\n    : resolve(false)\n}\n"],"names":[],"version":3,"file":"validateInNode.mjs.map","sourceRoot":"../"}